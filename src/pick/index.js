"use strict";const t=require("axios"),e=require("fs"),a=require("path"),r=require("https"),s=()=>({headers:{"Content-Type":"application/json"},httpsAgent:new r.Agent({rejectUnauthorized:!1})}),i={getStorageFilePath:()=>a.resolve(__dirname,"../source","index.js"),loadData(){const t=i.getStorageFilePath(),a=e.readFileSync(t,{encoding:"utf8"});return JSON.parse(a.toString("utf8"))},mergeData(t){const{lastUpdated:e,abstracts:a,libraries:r}=t,s=r.reduce(((t,e)=>(t[e.name]=e,t)),{});return{lastUpdated:e,data:a.map((t=>({...s[t[0]],description:t[1]})))}},async getData(){const t=a.resolve(__dirname,"../source","index.js");e.existsSync(t)||await i.update();const r=i.loadData(),{lastUpdated:s}=r;return Date.now()-s>854e5?(await i.update(),i.mergeData(i.loadData())):i.mergeData(r)},searchLibrary:async e=>(await t.get(`https://api.bootcdn.cn/libraries/${e}`,s())).data,createLink:(t,e,a)=>`https://cdn.bootcdn.net/ajax/libs/${t}/${e}/${a}`,async update(){const a=i.getStorageFilePath(),r=t.get("https://api.bootcdn.cn/libs.min.json",s()),n=t.get("https://api.bootcdn.cn/libraries",s()),[o,d]=await Promise.all([r,n]);e.writeFileSync(a,JSON.stringify({lastUpdated:Date.now(),abstracts:o.data,libraries:d.data.results}),{encoding:"utf8"})}};module.exports={libraries:i};
//# sourceMappingURL=index.js.map
